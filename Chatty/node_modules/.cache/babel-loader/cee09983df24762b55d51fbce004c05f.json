{"ast":null,"code":"var _jsxFileName = \"/Users/richardchannell/Projects/Chatty/Chatty/src/components/containers/Data.js\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport io from 'socket.io-client';\nimport { useScrollToBottom } from 'react-scroll-to-bottom';\nimport './Data.css';\n\nconst Data = () => {\n  const [yourID, setYourID] = useState();\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState([]);\n  const [username, setUsername] = useState([]);\n  const socketRef = useRef();\n  useEffect(() => {\n    socketRef.current = io.connect('/'); // Sets your ID on connection\n\n    socketRef.current.on(\"your id\", id => {\n      setYourID(id);\n    });\n    console.log(\"socket connection worked\");\n    socketRef.current.on(\"message\", message => {\n      recievedMessage(message);\n    }); // Gets the messages from the database and sets my messages with them. Peep the concat.\n\n    fetch(\"/api/messages\", {\n      method: \"GET\"\n    }).then(res => {\n      return res.json();\n    }).then(resJSON => {\n      console.log(resJSON);\n      setMessages(resJSON.concat());\n      updateScroll();\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n\n  function recievedMessage(message) {\n    setMessages(oldMsgs => [...oldMsgs, message]);\n  }\n\n  function sendMessage(e) {\n    e.preventDefault(); // Props on this guy match up with the schema.\n\n    const messageObject = {\n      body: message,\n      username: username,\n      id: yourID\n    };\n    setMessage(\"\");\n    updateScroll();\n    socketRef.current.emit(\"send message\", messageObject); // Sends the message to the database on submit. Uses the messageObject\n\n    fetch(\"/api/messages\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(messageObject)\n    }).then(res => {\n      return res.json();\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  function handleChange(e) {\n    setMessage(e.target.value);\n  }\n\n  function handleChangeUsername(e) {\n    setUsername(e.target.value);\n  }\n\n  function updateScroll() {\n    const element = document.getElementById(\"DbMsgs\");\n    const scrolly = useScrollToBottom;\n    element.scrolly(); // element.scrollTop = element.scrollHeight;\n\n    console.log('updateScroll ran!');\n  }\n\n  return (\n    /*#__PURE__*/\n    //Send down the info, render the chat shit\n    React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 5\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 7\n      }\n    }, messages.map((message, index) => {\n      if (message.id === yourID) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: \"MyRow\",\n          key: index,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"MyMessage\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 17\n          }\n        }, message.body));\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        key: index,\n        style: {\n          justifyContent: 'flex-start'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"PartnerMessage\",\n        id: \"DbMsgs\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 15\n        }\n      }, message.username, \":  \", message.body))));\n    }))), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"Entry\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: sendMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      value: message,\n      onChange: handleChange,\n      placeholder: \"Say something...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"Button\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 21\n      }\n    }))), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"UserEntry\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: sendMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      value: username,\n      onChange: handleChangeUsername,\n      placeholder: \"Your name...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }))))\n  );\n};\n\nexport default Data;","map":{"version":3,"sources":["/Users/richardchannell/Projects/Chatty/Chatty/src/components/containers/Data.js"],"names":["React","useState","useEffect","useRef","io","useScrollToBottom","Data","yourID","setYourID","messages","setMessages","message","setMessage","username","setUsername","socketRef","current","connect","on","id","console","log","recievedMessage","fetch","method","then","res","json","resJSON","concat","updateScroll","catch","err","oldMsgs","sendMessage","e","preventDefault","messageObject","body","emit","headers","JSON","stringify","handleChange","target","value","handleChangeUsername","element","document","getElementById","scrolly","map","index","justifyContent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport io from 'socket.io-client';\nimport { useScrollToBottom } from 'react-scroll-to-bottom';\n\nimport './Data.css';\n\nconst Data = () => {\n\n  const [yourID, setYourID] = useState();\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState([]);\n  const [username, setUsername] = useState([]);\n\n  const socketRef = useRef();\n\n  useEffect(() => {\n    socketRef.current = io.connect('/');   \n    // Sets your ID on connection\n    socketRef.current.on(\"your id\", id => {\n      setYourID(id)\n    })\n    console.log(\"socket connection worked\")\n    socketRef.current.on(\"message\", (message) => {\n    recievedMessage(message);\n    })\n    // Gets the messages from the database and sets my messages with them. Peep the concat.\n    fetch(\"/api/messages\", {\n      method: \"GET\",\n    }).then((res) => {\n      return res.json()\n    }).then((resJSON) => {\n      console.log(resJSON)\n      setMessages(resJSON.concat())\n      updateScroll()\n    }).catch((err) => {\n      console.log(err)\n    });\n  }, []);\n\n    function recievedMessage(message) {\n      setMessages(oldMsgs => [...oldMsgs, message])\n    }\n      \n    function sendMessage(e) {\n      e.preventDefault();\n      // Props on this guy match up with the schema.\n      const messageObject = {\n          body: message,\n          username: username,\n          id: yourID\n    };\n      setMessage(\"\")\n      updateScroll()\n      socketRef.current.emit(\"send message\", messageObject);\n      // Sends the message to the database on submit. Uses the messageObject\n      fetch(\"/api/messages\", {\n          method: \"POST\",\n          headers: {\n              \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify(messageObject)\n      }).then((res) => {\n          return res.json();\n      }).catch((err) => {\n          console.log(err);\n      });\n    }\n\n    function handleChange(e) {\n      setMessage(e.target.value);\n    }\n\n    function handleChangeUsername(e) {\n      setUsername(e.target.value);\n    }\n\n    function updateScroll(){\n      const element = document.getElementById(\"DbMsgs\");\n      const scrolly = useScrollToBottom;\n\n      element.scrolly()\n      // element.scrollTop = element.scrollHeight;\n      console.log('updateScroll ran!')\n    }\n\n  return (\n    //Send down the info, render the chat shit\n    <React.Fragment>\n    <div className=\"Page\">\n      <div className=\"Container\">\n        {messages.map((message, index) => {\n          if (message.id === yourID) {\n            return (\n              <div className=\"MyRow\" key={index}>\n                <div className=\"MyMessage\" >\n                  {message.body}\n                </div>\n              </div>\n            )\n          }\n          return (\n            <div key={index} style={{ justifyContent: 'flex-start' }} >\n              <ul>\n              <li>\n              <div className=\"PartnerMessage\" id=\"DbMsgs\">\n                {message.username}:  {message.body}\n              </div>\n              </li>\n              </ul>\n            </div>\n            )\n          })}\n        </div>\n      </div>\n\n            <span className=\"Entry\">\n                <form onSubmit={sendMessage}>\n                    <input \n                    value={message} \n                    onChange={handleChange} \n                    placeholder=\"Say something...\" />\n                    <button className=\"Button\" />\n                </form>\n            </span>\n\n            <span className=\"UserEntry\">\n              <form onSubmit={sendMessage}>\n                <input\n                    value={username}\n                    onChange={handleChangeUsername}\n                    placeholder=\"Your name...\" />\n              </form>\n            </span>\n        </React.Fragment>\n    )\n}  \n\nexport default Data;"]},"metadata":{},"sourceType":"module"}